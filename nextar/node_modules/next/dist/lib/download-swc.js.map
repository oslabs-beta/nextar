{"version":3,"sources":["../../src/lib/download-swc.ts"],"names":["downloadNativeNextSwc","downloadWasmSwc","fetch","require","WritableStream","MAX_VERSIONS_TO_CACHE","getCacheDirectory","result","envDefined","process","env","systemCacheDirectory","platform","XDG_CACHE_HOME","path","join","os","homedir","LOCALAPPDATA","dir","tmpdir","fileExists","console","error","Error","exit","isAbsolute","resolve","cwd","extractBinary","outputDirectory","pkgName","tarFileName","cacheDirectory","extractFromTar","tar","x","file","strip","Log","info","fs","promises","mkdir","recursive","tempFile","Date","now","registry","getRegistry","downloadUrl","then","res","ok","body","status","cacheWriteStream","createWriteStream","pipeTo","write","chunk","close","rename","cacheFiles","readdir","length","sort","a","b","localeCompare","i","unlink","catch","version","bindingsDirectory","triplesABI","triple","substring","wasmDirectory","variant"],"mappings":"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"}