{"version":3,"sources":["../../../src/experimental/testmode/server.ts"],"names":["interceptTestApis","wrapRequestHandler","testStorage","AsyncLocalStorage","buildProxyRequest","testData","request","url","method","headers","body","cache","credentials","integrity","mode","redirect","referrer","referrerPolicy","api","Array","from","Buffer","arrayBuffer","toString","buildResponse","proxyResponse","status","response","Response","Headers","handleFetch","originalFetch","testInfo","getStore","Error","proxyPort","proxyRequest","resp","JSON","stringify","ok","json","interceptFetch","global","fetch","testFetch","input","init","next","internal","Request","clientRequestInterceptor","ClientRequestInterceptor","on","respondWith","apply","dispose","handler","req","res","parsedUrl","proxyPortHeader","Number","testReqInfo","run"],"mappings":"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"}