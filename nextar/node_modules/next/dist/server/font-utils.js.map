{"version":3,"sources":["../../src/server/font-utils.ts"],"names":["getFontDefinitionFromNetwork","getFontDefinitionFromManifest","calculateOverrideValues","calculateSizeAdjustValues","getFontOverrideCss","capsizeFontsMetrics","require","https","CHROME_UA","IE_UA","isGoogleFont","url","startsWith","GOOGLE_FONT_PROVIDER","getFontForUA","UA","Promise","resolve","reject","rawData","get","headers","res","on","chunk","toString","e","result","Log","warn","manifest","find","font","content","parseGoogleFontName","css","regex","matches","matchAll","fontNames","Set","fontFamily","replace","add","formatName","str","word","index","toLowerCase","toUpperCase","formatOverrideValue","val","Math","abs","toFixed","fontName","fontKey","fontMetrics","category","ascent","descent","lineGap","unitsPerEm","fallbackFont","DEFAULT_SERIF_FONT","DEFAULT_SANS_SERIF_FONT","name","xWidthAvg","mainFontAvgWidth","fallbackFontName","fallbackFontMetrics","fallbackFontAvgWidth","sizeAdjust","calculateOverrideCSS","trim","calculateSizeAdjustCSS","useSizeAdjust","calcFn","fontCss","reduce","cssStr","console","log"],"mappings":"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"}