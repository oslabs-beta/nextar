{"version":3,"sources":["../../../../src/server/lib/squoosh/main.ts"],"names":["getMetadata","processBuffer","decodeBuffer","getWorker","execOnce","Worker","path","resolve","__dirname","enableWorkerThreads","numWorkers","Math","max","min","cpus","length","computeWorkerKey","method","buffer","worker","width","height","operations","encoding","quality","imageData","operation","type","rotate","numRotations","opt","image","resize","Buffer","from","encodeJpeg","encodeWebp","avifQuality","encodeAvif","encodePng","Error"],"mappings":";;;;;;;;;;;;;;;;IA8BsBA,WAAW;eAAXA;;IAQAC,aAAa;eAAbA;;IAsDAC,YAAY;eAAZA;;;4BA5FC;8DACD;uBACG;oBACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBrB,MAAMC,YAAYC,IAAAA,eAAQ,EACxB,IACE,IAAIC,kBAAM,CAACC,MAAKC,OAAO,CAACC,WAAW,SAAS;QAC1CC,qBAAqB,IAAI;QACzB,qEAAqE;QACrE,6BAA6B;QAC7BC,YAAYC,KAAKC,GAAG,CAAC,GAAGD,KAAKE,GAAG,CAACC,IAAAA,QAAI,IAAGC,MAAM,GAAG,GAAG;QACpDC,kBAAkB,CAACC,SAAWA;IAChC;AAGG,eAAejB,YACpBkB,MAAc,EAC8B;IAC5C,MAAMC,SAAkChB;IACxC,MAAM,EAAEiB,MAAK,EAAEC,OAAM,EAAE,GAAG,MAAMF,OAAOjB,YAAY,CAACgB;IACpD,OAAO;QAAEE;QAAOC;IAAO;AACzB;AAEO,eAAepB,cACpBiB,MAAc,EACdI,UAAuB,EACvBC,QAAkB,EAClBC,OAAe,EACE;IACjB,MAAML,SAAkChB;IAExC,IAAIsB,YAAY,MAAMN,OAAOjB,YAAY,CAACgB;IAC1C,KAAK,MAAMQ,aAAaJ,WAAY;QAClC,IAAII,UAAUC,IAAI,KAAK,UAAU;YAC/BF,YAAY,MAAMN,OAAOS,MAAM,CAACH,WAAWC,UAAUG,YAAY;QACnE,OAAO,IAAIH,UAAUC,IAAI,KAAK,UAAU;YACtC,MAAMG,MAAM;gBAAEC,OAAON;gBAAWL,OAAO;gBAAGC,QAAQ;YAAE;YACpD,IACEK,UAAUN,KAAK,IACfK,UAAUL,KAAK,IACfK,UAAUL,KAAK,GAAGM,UAAUN,KAAK,EACjC;gBACAU,IAAIV,KAAK,GAAGM,UAAUN,KAAK;YAC7B,CAAC;YACD,IACEM,UAAUL,MAAM,IAChBI,UAAUJ,MAAM,IAChBI,UAAUJ,MAAM,GAAGK,UAAUL,MAAM,EACnC;gBACAS,IAAIT,MAAM,GAAGK,UAAUL,MAAM;YAC/B,CAAC;YAED,IAAIS,IAAIV,KAAK,GAAG,KAAKU,IAAIT,MAAM,GAAG,GAAG;gBACnCI,YAAY,MAAMN,OAAOa,MAAM,CAACF;YAClC,CAAC;QACH,CAAC;IACH;IAEA,OAAQP;QACN,KAAK;YACH,OAAOU,OAAOC,IAAI,CAAC,MAAMf,OAAOgB,UAAU,CAACV,WAAW;gBAAED;YAAQ;QAClE,KAAK;YACH,OAAOS,OAAOC,IAAI,CAAC,MAAMf,OAAOiB,UAAU,CAACX,WAAW;gBAAED;YAAQ;QAClE,KAAK;YACH,MAAMa,cAAcb,UAAU;YAC9B,OAAOS,OAAOC,IAAI,CAChB,MAAMf,OAAOmB,UAAU,CAACb,WAAW;gBACjCD,SAASb,KAAKC,GAAG,CAACyB,aAAa;YACjC;QAEJ,KAAK;YACH,OAAOJ,OAAOC,IAAI,CAAC,MAAMf,OAAOoB,SAAS,CAACd;QAC5C;YACE,MAAMe,MAAM,CAAC,2BAA2B,CAAC,EAAC;IAC9C;AACF;AAEO,eAAetC,aAAagB,MAAc,EAAE;IACjD,MAAMC,SAAkChB;IACxC,MAAMsB,YAAY,MAAMN,OAAOjB,YAAY,CAACgB;IAC5C,OAAOO;AACT"}