{"version":3,"sources":["../../src/server/web-server.ts"],"names":["byteLength","BaseServer","NoFallbackError","generateETag","addRequestMeta","WebResponseCache","isAPIRoute","getPathMatch","getRouteFromAssetPath","normalizeLocalePath","removeTrailingSlash","isDynamicRoute","interpolateDynamicPath","normalizeVercelUrl","getNamedRouteRegex","IncrementalCache","NextWebServer","constructor","options","Object","assign","renderOpts","webServerConfig","extendRenderOpts","handleCompression","getIncrementalCache","requestHeaders","dev","requestProtocol","appDir","hasAppDir","allowedRevalidateHeaderKeys","nextConfig","experimental","minimalMode","fetchCache","fetchCacheKeyPrefix","maxMemoryCacheSize","isrMemoryCacheSize","flushToDisk","CurCacheHandler","serverOptions","incrementalCacheHandler","getPrerenderManifest","getResponseCache","getCustomRoutes","headers","rewrites","fallback","afterFiles","beforeFiles","redirects","run","req","res","parsedUrl","hasPage","page","getPublicDir","getBuildId","buildId","loadEnvConfig","getHasAppDir","pagesType","getHasStaticDir","getFallback","getFontManifest","undefined","getPagesManifest","normalizedPage","getAppPathsManifest","getFilesystemPaths","Set","attachRequestMeta","query","prerenderManifest","version","routes","dynamicRoutes","notFoundRoutes","preview","previewModeId","getNextFontManifest","nextFontManifest","normalizeNextData","middleware","getMiddleware","params","pathname","path","render404","finished","shift","lastParam","length","endsWith","join","trailingSlash","substring","i18n","host","hostname","split","toLowerCase","localePathResult","locales","domainLocale","i18nProvider","detectDomainLocale","detectedLocale","__nextLocale","__nextDefaultLocale","defaultLocale","__nextDataReq","handleCatchallRenderRequest","Error","routeRegex","keys","routeKeys","analyze","bubbleNoFallback","_nextBubbleNoFallback","render","err","handleApiRequest","renderHTML","renderToHTML","disableOptimizedLoading","runtime","sendRenderResult","_req","setHeader","poweredByHeader","type","getHeader","result","contentType","isDynamic","writer","transformStream","writable","getWriter","innerClose","target","write","chunk","end","close","on","_event","cb","off","_cb","onClose","closed","then","pipe","payload","toUnchunkedString","String","generateEtags","body","send","runApi","findPageComponents","loadComponent","components"],"mappings":"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"}