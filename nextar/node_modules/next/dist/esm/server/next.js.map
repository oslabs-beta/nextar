{"version":3,"sources":["../../src/server/next.ts"],"names":["log","loadConfig","resolve","NON_STANDARD_NODE_ENV","PHASE_DEVELOPMENT_SERVER","PHASE_PRODUCTION_SERVER","getTracer","NextServerSpan","formatUrl","checkIsNodeDebugging","ServerImpl","getServerImpl","undefined","Promise","require","default","SYMBOL_LOAD_CONFIG","Symbol","NextServer","constructor","options","hostname","port","getRequestHandler","req","res","parsedUrl","trace","requestHandler","getServerRequestHandler","getUpgradeHandler","socket","head","server","getServer","handleUpgrade","apply","setAssetPrefix","assetPrefix","preparedAssetPrefix","logError","args","render","renderToHTML","renderError","renderErrorToHTML","render404","prepare","serverFields","standaloneMode","Object","assign","dev","close","createServer","ServerImplementation","preloadedConfig","dir","conf","_renderWorker","serverPromise","then","process","env","__NEXT_PRIVATE_STANDALONE_CONFIG","JSON","stringify","output","warn","Error","reqHandler","reqHandlerPromise","wrap","bind","NextCustomServer","getRequestHandlers","isNodeDebugging","initResult","isDev","minimalMode","upgradeHandler","setupWebSocketHandler","customServer","_req","didWebSocketSetup","on","httpServer","url","pathname","query","startsWith","console","error","typescript","createTSPlugin","NODE_ENV","includes","module","exports"],"mappings":"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"}