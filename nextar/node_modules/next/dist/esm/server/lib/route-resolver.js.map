{"version":3,"sources":["../../../src/server/lib/route-resolver.ts"],"names":["url","path","http","findPageFile","getRequestMeta","setupDebug","getCloneableBody","findPagesDir","setupFsCheck","proxyRequest","getResolveRoutes","PERMANENT_REDIRECT_STATUS","splitCookiesString","toNodeOutgoingHttpHeaders","formatHostname","signalFromNodeResponse","getMiddlewareRouteMatcher","pipeReadable","debug","makeResolver","dir","nextConfig","middleware","hostname","port","fsChecker","dev","minimalMode","config","appDir","pagesDir","experimental","fetchHostname","ensureCallback","item","result","type","Error","itemPath","pageExtensions","distDir","join","middlewareInfo","name","paths","files","map","file","process","cwd","wasm","assets","middlewareServerAddr","Promise","resolve","srv","createServer","req","res","cloneableBody","run","require","edgeFunctionEntry","request","headers","method","i18n","basePath","trailingSlash","body","signal","useCache","onWarning","console","warn","key","value","response","toLowerCase","delete","cookies","cookie","append","Object","entries","undefined","setHeader","statusCode","status","end","err","error","on","srvAddr","address","listen","length","middlewareMatcher","matcher","regexp","originalSource","resolveRoutes","isNodeDebugging","workerType","pages","initialize","deleteCache","clearModuleContext","deleteAppClientCache","propagateServerField","resolveRoute","routeResult","Set","matchedOutput","bodyStream","parsedUrl","resHeaders","finished","pathname","query","keys","destination","format","protocol","cloneBodyStream","proxyTimeout"],"mappings":"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"}