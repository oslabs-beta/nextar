{"version":3,"sources":["../../../../src/server/lib/squoosh/main.ts"],"names":["Worker","path","execOnce","cpus","getWorker","resolve","__dirname","enableWorkerThreads","numWorkers","Math","max","min","length","computeWorkerKey","method","getMetadata","buffer","worker","width","height","decodeBuffer","processBuffer","operations","encoding","quality","imageData","operation","type","rotate","numRotations","opt","image","resize","Buffer","from","encodeJpeg","encodeWebp","avifQuality","encodeAvif","encodePng","Error"],"mappings":"AAAA,SAASA,MAAM,QAAQ,iCAAgC;AACvD,YAAYC,UAAU,OAAM;AAC5B,SAASC,QAAQ,QAAQ,4BAA2B;AACpD,SAASC,IAAI,QAAQ,KAAI;AAgBzB,MAAMC,YAAYF,SAChB,IACE,IAAIF,OAAOC,KAAKI,OAAO,CAACC,WAAW,SAAS;QAC1CC,qBAAqB,IAAI;QACzB,qEAAqE;QACrE,6BAA6B;QAC7BC,YAAYC,KAAKC,GAAG,CAAC,GAAGD,KAAKE,GAAG,CAACR,OAAOS,MAAM,GAAG,GAAG;QACpDC,kBAAkB,CAACC,SAAWA;IAChC;AAGJ,OAAO,eAAeC,YACpBC,MAAc,EAC8B;IAC5C,MAAMC,SAAkCb;IACxC,MAAM,EAAEc,MAAK,EAAEC,OAAM,EAAE,GAAG,MAAMF,OAAOG,YAAY,CAACJ;IACpD,OAAO;QAAEE;QAAOC;IAAO;AACzB,CAAC;AAED,OAAO,eAAeE,cACpBL,MAAc,EACdM,UAAuB,EACvBC,QAAkB,EAClBC,OAAe,EACE;IACjB,MAAMP,SAAkCb;IAExC,IAAIqB,YAAY,MAAMR,OAAOG,YAAY,CAACJ;IAC1C,KAAK,MAAMU,aAAaJ,WAAY;QAClC,IAAII,UAAUC,IAAI,KAAK,UAAU;YAC/BF,YAAY,MAAMR,OAAOW,MAAM,CAACH,WAAWC,UAAUG,YAAY;QACnE,OAAO,IAAIH,UAAUC,IAAI,KAAK,UAAU;YACtC,MAAMG,MAAM;gBAAEC,OAAON;gBAAWP,OAAO;gBAAGC,QAAQ;YAAE;YACpD,IACEO,UAAUR,KAAK,IACfO,UAAUP,KAAK,IACfO,UAAUP,KAAK,GAAGQ,UAAUR,KAAK,EACjC;gBACAY,IAAIZ,KAAK,GAAGQ,UAAUR,KAAK;YAC7B,CAAC;YACD,IACEQ,UAAUP,MAAM,IAChBM,UAAUN,MAAM,IAChBM,UAAUN,MAAM,GAAGO,UAAUP,MAAM,EACnC;gBACAW,IAAIX,MAAM,GAAGO,UAAUP,MAAM;YAC/B,CAAC;YAED,IAAIW,IAAIZ,KAAK,GAAG,KAAKY,IAAIX,MAAM,GAAG,GAAG;gBACnCM,YAAY,MAAMR,OAAOe,MAAM,CAACF;YAClC,CAAC;QACH,CAAC;IACH;IAEA,OAAQP;QACN,KAAK;YACH,OAAOU,OAAOC,IAAI,CAAC,MAAMjB,OAAOkB,UAAU,CAACV,WAAW;gBAAED;YAAQ;QAClE,KAAK;YACH,OAAOS,OAAOC,IAAI,CAAC,MAAMjB,OAAOmB,UAAU,CAACX,WAAW;gBAAED;YAAQ;QAClE,KAAK;YACH,MAAMa,cAAcb,UAAU;YAC9B,OAAOS,OAAOC,IAAI,CAChB,MAAMjB,OAAOqB,UAAU,CAACb,WAAW;gBACjCD,SAASf,KAAKC,GAAG,CAAC2B,aAAa;YACjC;QAEJ,KAAK;YACH,OAAOJ,OAAOC,IAAI,CAAC,MAAMjB,OAAOsB,SAAS,CAACd;QAC5C;YACE,MAAMe,MAAM,CAAC,2BAA2B,CAAC,EAAC;IAC9C;AACF,CAAC;AAED,OAAO,eAAepB,aAAaJ,MAAc,EAAE;IACjD,MAAMC,SAAkCb;IACxC,MAAMqB,YAAY,MAAMR,OAAOG,YAAY,CAACJ;IAC5C,OAAOS;AACT,CAAC"}