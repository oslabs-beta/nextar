{"version":3,"sources":["../../../../src/build/webpack/plugins/build-manifest-plugin.ts"],"names":["srcEmptySsgManifest","getEntrypointFiles","BuildManifestPlugin","generateClientManifest","compiler","compilation","assetMap","rewrites","compilationSpan","spans","get","genClientManifestSpan","traceChild","normalizeRewrite","item","has","source","destination","traceFn","clientManifest","__rewrites","afterFiles","map","beforeFiles","fallback","appDependencies","Set","pages","sortedPageKeys","getSortedRoutes","Object","keys","forEach","page","dependencies","filteredDeps","filter","dep","length","sortedPages","devalue","entrypoint","getFiles","file","test","replace","processRoute","r","rewrite","startsWith","constructor","options","buildId","isDevFallback","appDirEnabled","exportRuntime","createAssets","assets","createAssetsSpan","entrypoints","polyfillFiles","devFiles","ampDevFiles","lowPriorityFiles","rootMainFiles","ampFirstPages","ampFirstEntryNames","ampFirstEntryNamesMap","entryName","pagePath","getRouteFromEntrypoint","push","mainFiles","CLIENT_STATIC_FILES_RUNTIME_MAIN","CLIENT_STATIC_FILES_RUNTIME_MAIN_APP","compilationAssets","getAssets","p","name","endsWith","info","CLIENT_STATIC_FILES_RUNTIME_POLYFILLS_SYMBOL","v","CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH","CLIENT_STATIC_FILES_RUNTIME_AMP","values","SYSTEM_ENTRYPOINTS","filesForPage","CLIENT_STATIC_FILES_PATH","ssgManifestPath","sources","RawSource","sort","reduce","a","c","buildManifestName","BUILD_MANIFEST","JSON","stringify","MIDDLEWARE_BUILD_MANIFEST","clientManifestPath","apply","hooks","make","tap","processAssets","stage","webpack","Compilation","PROCESS_ASSETS_STAGE_ADDITIONS"],"mappings":"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"}